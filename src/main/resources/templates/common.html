<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head th:fragment="commonHead(title)">
    <meta charset="UTF-8">
    <title th:text="${title}">进销存</title>

    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="/css/dashboard.css" rel="stylesheet">
</head>
<body>

<nav class="sidebar" th:fragment="sidebar(activeGroup, activeUri)">
    <a class="sidebar-brand" href="/">
        <div style="background:#4e73df; color:#fff; padding:6px; border-radius:8px; margin-right:10px;">
            <i class="bi bi-box-seam-fill"></i>
        </div>
        ERP系统
    </a>

    <div class="nav flex-column py-2">
        <a class="nav-link" th:classappend="${activeUri == 'index'} ? 'active'" href="/">
            <div><i class="bi bi-speedometer2 bi-icon"></i> 仪表盘</div>
        </a>

        <div class="sidebar-heading">业务管理</div>

        <a class="nav-link" th:classappend="${activeGroup == 'product'} ? '' : 'collapsed'"
           data-bs-toggle="collapse" href="#" data-bs-target="#menuProduct">
            <div><i class="bi bi-bag bi-icon"></i> 商品管理</div>
            <i class="bi bi-chevron-right arrow-icon"></i>
        </a>
        <div class="collapse" id="menuProduct" th:classappend="${activeGroup == 'product'} ? 'show'">
            <nav class="nav flex-column">
                <a class="nav-link" th:classappend="${activeUri == 'product_list'} ? 'active'" href="/page/product/list">商品列表</a>
                <a class="nav-link" th:classappend="${activeUri == 'product_add'} ? 'active'" href="/page/product/add">商品录入</a>
            </nav>
        </div>

        <a class="nav-link" th:classappend="${activeGroup == 'inbound'} ? '' : 'collapsed'"
           data-bs-toggle="collapse" href="#" data-bs-target="#menuInbound">
            <div><i class="bi bi-cart3 bi-icon"></i> 采购管理</div>
            <i class="bi bi-chevron-right arrow-icon"></i>
        </a>
        <div class="collapse" id="menuInbound" th:classappend="${activeGroup == 'inbound'} ? 'show'">
            <nav class="nav flex-column">
                <a class="nav-link" th:classappend="${activeUri == 'inbound_create'} ? 'active'" href="/page/inbound/create">采购下单</a>
                <a class="nav-link" th:classappend="${activeUri == 'inbound_receive'} ? 'active'" href="/page/inbound/receive">采购入库</a>
                <a class="nav-link" th:classappend="${activeUri == 'inbound_list'} ? 'active'" href="/page/inbound/list">订单记录</a>
            </nav>
        </div>

        <a class="nav-link" th:classappend="${activeGroup == 'sale'} ? '' : 'collapsed'"
           data-bs-toggle="collapse" href="#" data-bs-target="#menuSale">
            <div><i class="bi bi-shop bi-icon"></i> 销售管理</div>
            <i class="bi bi-chevron-right arrow-icon"></i>
        </a>
        <div class="collapse" id="menuSale" th:classappend="${activeGroup == 'sale'} ? 'show'">
            <nav class="nav flex-column">
                <a class="nav-link" th:classappend="${activeUri == 'sale_create'} ? 'active'" href="/page/sale/create">收银台</a>
                <a class="nav-link" th:classappend="${activeUri == 'sale_list'} ? 'active'" href="/page/sale/list">销售流水</a>
            </nav>
        </div>

        <a class="nav-link" th:classappend="${activeGroup == 'stock'} ? '' : 'collapsed'"
           data-bs-toggle="collapse" href="#" data-bs-target="#menuStock">
            <div><i class="bi bi-boxes bi-icon"></i> 库存中心</div>
            <i class="bi bi-chevron-right arrow-icon"></i>
        </a>
        <div class="collapse" id="menuStock" th:classappend="${activeGroup == 'stock'} ? 'show'">
            <nav class="nav flex-column">
                <a class="nav-link" th:classappend="${activeUri == 'stock_list'} ? 'active'" href="/page/stock/list">实时库存</a>
                <a class="nav-link" th:classappend="${activeUri == 'stock_warning'} ? 'active'" href="/page/stock/warning">库存预警</a>
            </nav>
        </div>

        <a class="nav-link" th:classappend="${activeGroup == 'finance'} ? '' : 'collapsed'"
           data-bs-toggle="collapse" href="#" data-bs-target="#menuFinance">
            <div><i class="bi bi-currency-yen bi-icon"></i> 财务管理</div>
            <i class="bi bi-chevron-right arrow-icon"></i>
        </a>
        <div class="collapse" id="menuFinance" th:classappend="${activeGroup == 'finance'} ? 'show'">
            <nav class="nav flex-column">
                <a class="nav-link" th:classappend="${activeUri == 'finance_flow'} ? 'active'" href="/page/finance/flow">资金流水</a>
                <a class="nav-link" th:classappend="${activeUri == 'finance_chart'} ? 'active'" href="/page/finance/chart">财务报表</a>
            </nav>
        </div>

        <div class="sidebar-heading">系统设置</div>

        <a class="nav-link" th:classappend="${activeGroup == 'system'} ? '' : 'collapsed'"
           data-bs-toggle="collapse" href="#" data-bs-target="#menuSystem">
            <div><i class="bi bi-gear bi-icon"></i> 系统管理</div>
            <i class="bi bi-chevron-right arrow-icon"></i>
        </a>
        <div class="collapse" id="menuSystem" th:classappend="${activeGroup == 'system'} ? 'show'">
            <nav class="nav flex-column">
                <a class="nav-link" th:classappend="${activeUri == 'user_list'} ? 'active'" href="/page/system/user/list">用户列表</a>
                <a class="nav-link" th:classappend="${activeUri == 'user_add'} ? 'active'" href="/page/system/user/add">新增用户</a>
            </nav>
        </div>
    </div>
</nav>

<header class="navbar-top" th:fragment="topbar">
    <div class="d-flex align-items-center ms-auto">
        <div class="dropdown">
            <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle text-dark" data-bs-toggle="dropdown">
                <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2" style="width:32px;height:32px;">A</div>
                <span class="small fw-bold text-gray-600">管理员</span>
            </a>
            <ul class="dropdown-menu dropdown-menu-end shadow border-0 animated--grow-in">
                <li><a class="dropdown-item" href="#">个人信息</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item text-danger" href="/login">退出登录</a></li>
            </ul>
        </div>
    </div>
</header>

<div th:fragment="commonScripts">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>

    <script>
        $(document).ready(function() {
            // 简单的 JS 验证，确保文件已加载
            console.log("✅ 布局模板加载完毕");
        });
    </script>
</div>

</body>
</html>